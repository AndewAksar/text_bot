# Telegram Text Bot

Telegram-бот, который реагирует на триггерные слова или фразы в сообщениях в заданной группе, отправляя заранее заданные ответы с учётом задержки и ограничения частоты.

## Описание

Бот предназначен для автоматической обработки текстовых сообщений в Telegram-группе. Он реагирует на ключевые слова или фразы, определённые в конфигурации, и отправляет ответы с заданной задержкой. Поддерживает ограничение частоты ответов и логирование для отладки.

### Основные возможности
- Реакция на триггерные слова или фразы с использованием регулярных выражений.
- Настраиваемые ответы и задержки для каждого триггера.
- Ограничение частоты ответов (не чаще одного ответа каждые 10 секунд).
- Логирование действий и обработка ошибок Telegram API.
- Хранение конфиденциальных данных в переменных окружения (`.env`).

## Структура проекта
```
text_bot/
│
├── config/
│   ├── init.py        # Пустой файл для пакета
│   ├── bot.py            # Конфигурация бота (токен, ID группы)
│   ├── triggers.py       # Триггеры и ответы
│
├── handlers/
│   ├── init.py        # Пустой файл
│   ├── commands.py       # Обработчик команды /start
│   ├── messages.py       # Обработчик текстовых сообщений
│
├── utils/
│   ├── init.py        # Пустой файл
│   ├── logging.py        # Настройка логирования
│   ├── response.py       # Логика отправки ответов и обработки ошибок
│
├── main.py                # Точка входа для запуска бота
├── requirements.txt       # Зависимости проекта
├── .gitignore             # Исключения для Git
├── .env.example          # Пример файла с переменными окружения
├── README.md             # Документация проекта
```

## Требования

- Python 3.8 или выше
- Токен Telegram-бота (получите через [BotFather](https://t.me/BotFather))
- ID целевой Telegram-группы
- Установленные зависимости из `requirements.txt`

## Установка

1. **Клонируйте репозиторий**:

   ```bash
   git clone <URL_репозитория>
   cd text_bot

2. **Создайте виртуальное окружение (рекомендуется)**:
    
   ```bash
    python -m venv venv
    source venv/bin/activate  # Linux/Mac
    venv\Scripts\activate     # Windows

3. **Установите зависимости**:
    
    ```bash
   pip install -r requirements.txt

4. **Настройте переменные окружения**:
    
    ```bash
   cp .env.example .env

5. **Отредактируйте .env, указав токен и ID группы**:
    
    ```
    TELEGRAM_TOKEN=ваш_токен
    GROUP_CHAT_ID=-123456789
    ```
6. **Добавьте .env в .gitignore**:

   **Убедитесь, что .env не отслеживается Git**:
    
    ```bash
   echo ".env" >> .gitignore


## Запуск

1. **Активируйте виртуальное окружение (если создавали)**:
    
    ```bash
    source venv/bin/activate  # Linux/Mac
    venv\Scripts\activate     # Windows
   
2. **Запустите бота**:
    
    ```bash
   python main.py
   
**Бот начнёт обрабатывать сообщения в указанной группе.**

## Использование

- Отправьте команду `/start` в чате с ботом, чтобы получить ID чата и подтверждение работы.
- Бот реагирует только на сообщения в группе с ID, указанным в `GROUP_CHAT_ID`.
- Настройка триггеров и ответов выполняется в файле `config/triggers.py`.

## Расширение

- Добавление триггеров: Добавьте новые экземпляры класса `Trigger` в `config/triggers.py`.
- Настройка логирования: Измените уровень или формат логов в `utils/logging.py`.
- Деплой: Настройте переменные окружения на сервере (Heroku, AWS, etc.) вместо `.env`.

## Устранение неполадок


- Ошибка `"chat not found"`: Проверьте, добавлен ли бот в группу и имеет ли он права на отправку сообщений.
- Конфликт `getUpdates`: Убедитесь, что запущен только один экземпляр бота. Удалите вебхук, если он активен:

    ```bash
  curl https://api.telegram.org/bot<TELEGRAM_TOKEN>/deleteWebhook

- Переменные окружения не найдены: Проверьте наличие и корректность файла .env.

## Зависимости

- `pip install python-telegram-bot` — для работы с Telegram API
- `pip install python-dotenv` — для загрузки переменных из .env
